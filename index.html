<script>
  document.getElementById('contactForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    console.log("Formulário submetido - Iniciando processamento");
    
    // Reset dos alertas
    document.getElementById('successAlert').style.display = 'none';
    document.getElementById('errorAlert').style.display = 'none';
    document.getElementById('loading').style.display = 'block';
    
    try {
      // Coleta os dados do formulário
      const formData = new FormData(this);
      const params = new URLSearchParams();
      
      // Adiciona os parâmetros manualmente para garantir o formato correto
      params.append('nome', formData.get('nome'));
      params.append('email', formData.get('email'));
      params.append('mensagem', formData.get('mensagem'));
      
      console.log("Dados do formulário:", Object.fromEntries(params.entries()));
      
      const response = await fetch('https://script.google.com/macros/s/AKfycbwqVhjkzR0BRN3aAoMFPfE5rth4JEg6djItd9615XVIafs8HP3ekTDzFyyl-0HVg4Zveg/exec', {
        method: 'POST',
        body: params,
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
        },
        redirect: 'follow'
      });
      
      console.log("Resposta recebida - Status:", response.status);
      
      // Processa a resposta independente do tipo de conteúdo
      const textResponse = await response.text();
      let result;
      
      try {
        // Tenta parsear como JSON
        result = JSON.parse(textResponse);
      } catch (e) {
        // Se não for JSON, trata como texto
        throw new Error(textResponse || "Resposta vazia do servidor");
      }
      
      console.log("Resposta processada:", result);
      
      document.getElementById('loading').style.display = 'none';
      
      if (result.status === 'success') {
        document.getElementById('successAlert').textContent = result.message;
        document.getElementById('successAlert').style.display = 'block';
        this.reset();
      } else {
        document.getElementById('errorAlert').textContent = result.message;
        document.getElementById('errorAlert').style.display = 'block';
      }
    } catch (error) {
      console.error("Erro no envio:", error);
      document.getElementById('loading').style.display = 'none';
      document.getElementById('errorAlert').textContent = 'Erro: ' + error.message;
      document.getElementById('errorAlert').style.display = 'block';
    }
  });
</script>
