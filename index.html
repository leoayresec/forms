<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial, sans-serif; max-width: 500px; margin: 0 auto; padding: 20px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input, select { width: 100%; padding: 8px; box-sizing: border-box; }
    button { background: #4285f4; color: white; border: none; padding: 10px 15px; cursor: pointer; }
    button:hover { background: #3367d6; }
    #resultado { margin-top: 15px; padding: 10px; border-radius: 4px; }
    .success { background: #e6f4ea; color: #137333; }
    .error { background: #fce8e6; color: #d93025; }
  </style>
</head>
<body>
  <h2>Registrar Aposta</h2>
  
  <div class="form-group">
    <label for="data">Data:</label>
    <input type="date" id="data" required>
  </div>
  
  <div class="form-group">
    <label for="odd">Odd:</label>
    <input type="number" id="odd" step="0.01" min="1" required>
  </div>
  
  <div class="form-group">
    <label for="resultado">Resultado:</label>
    <select id="resultado" required>
      <option value="">Selecione...</option>
      <option value="Green">Green</option>
      <option value="Red">Red</option>
    </select>
  </div>
  
  <button onclick="enviarDados()">Registrar</button>
  
  <div id="resultado"></div>
  
  <script>
    function enviarDados() {
      const dataInput = document.getElementById("data").value;
      const odd = parseFloat(document.getElementById("odd").value);
      const resultado = document.getElementById("resultado").value;
      
      if (!dataInput || isNaN(odd) || !resultado) {
        mostrarResultado("Preencha todos os campos corretamente", false);
        return;
      }
      
      const dados = {
        data: dataInput,
        odd: odd,
        resultado: resultado
      };
      
      google.script.run
        .withSuccessHandler(function(res) {
          mostrarResultado(res.message, true);
          document.getElementById("form").reset();
        })
        .withFailureHandler(function(err) {
          mostrarResultado("Erro: " + err.message, false);
        })
        .registrarAposta(dados);
    }
    
    function mostrarResultado(mensagem, sucesso) {
      const div = document.getElementById("resultado");
      div.textContent = mensagem;
      div.className = sucesso ? "success" : "error";
    }
  </script>
</body>
</html>
